<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type='text/xsl' href='./OpenSocial.xslt' ?>
<?rfc toc="yes"?>
<?rfc-ext allow-markup-in-artwork="yes"?>
<!DOCTYPE rfc PUBLIC "-//IETF//DTD RFC 2629//EN"
"http://xml.resource.org/authoring/rfc2629.dtd">
<rfc ipr="full3978"
     docName="opensocial-data-specification-draft"
     xmlns:x="http://purl.org/net/xml2rfc/ext">
 <front>
  <title>OpenSocial Data Specification (draft)</title>
  <author fullname='OpenSocial and Gadgets Specification Group'>
   <address>
    <email>opensocial-and-gadgets-spec@googlegroups.com</email>
   </address>
  </author>
  <date month="September"
        year="2009" />
  <abstract>
   <t>This document defines all the data objects used in the OpenSocial APIs.</t>
  </abstract>
 </front>
 <middle>
  <section title="Introduction">
   <section title="Requirements">
    <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
    document are to be interpreted as described in 
    <xref target="RFC2119">RFC2119</xref>.</t>
    <t>An implementation is not compliant if it fails to satisfy one or more of
    the MUST or REQUIRED level requirements for the protocols it
    implements.</t>
   </section>
   <section title="Terminology">
    <t>This specification uses a number of terms to refer to the roles played
    by participants in, and objects of, an OpenSocial implementation.</t>
    <list style="hanging">
     <t hangText="container">An implementor of the 
     <xref target="Gadget-Specification">Gadget specification</xref> </t>
    </list>
   </section>
  </section>
  <section title="Notational Conventions and Generic Grammar">
   <section title="Conventions">
    <t>Domain name examples use 
    <xref target="RFC2606">RFC2606</xref>.</t>
   </section>
   <section title="Augmented BNF">
    <t>The grammatical rules in this document are to be interpreted as
    described in <xref target="RFC2234">RFC4234</xref> (Augmented Backus-Naur 
    Form).</t>   
    <t>The following constructs are introduced in this document to augment 
    RFC4234:</t>
    <list style="hanging">
     <t hangText="{rule1 rule2}">
      <t>Elements enclosed in braces (squiggly brackets) are treated as a
      single, UNORDERED element. Its contents may occur in any order. Hence: 
      <artwork type="abnf" xml:space="preserve">{elem foo} bar</artwork>
      would match (elem foo bar) and (foo elem bar).</t>
      <t>NOTE: Specifying alternatives is quite different from specifying set
      grouping. Alternatives indicate the matching of exactly one (sub-)rule
      out of the total grouping. The set mechanism indicates the matching of a
      string which contains all of the elements within the group; however the
      elements may occur in any order.</t>
     </t>
     <t hangText="#rule">A construct "#" is defined, similar to "*", for
     defining lists of elements. The full form is "&lt;n&gt;#&lt;m&gt;element"
     indicating at least &lt;n&gt; and at most &lt;m&gt; elements, each
     separated by one or more commas (",") and OPTIONAL linear white space
     (LWS). This makes the usual form of lists very easy; a rule such as 
     <artwork type="inline" xml:space="preserve">( *LWS element *( *LWS "," *LWS element ))</artwork>
     can be shown as 
     <artwork type="inline" xml:space="preserve">1#element</artwork>
     Wherever this construct is used, null elements are allowed, but do
     not contribute to the count of elements present. That is, "(element), ,
     (element) " is permitted, but counts as only two elements. Therefore, 
     where at least one element is required, at least one non-null element MUST 
     be present.  Default values are 0 and infinity so that "#element" allows 
     any number, including zero; "1#element" requires at least one; and 
     "1#2element" allows one or two.</t>
     <t hangText="&amp;rule">A construct "&amp;" is defined, similar to "#",
     which uses an ampersand (&amp;) instead of commas, and MUST NOT include
     linear white space between elements.</t>
     <t hangText="implied *LWS">The grammar described by this specification is
     word-based. Except where noted otherwise, linear white space (LWS) can be
     included between any two adjacent words (token or quoted-string), and
     between adjacent words and separators, without changing the interpretation
     of a field. At least one delimiter (LWS and/or separators) MUST exist
     between any two tokens, since they would otherwise be interpreted as a
     single token.</t>
    </list>
   </section>
   <section title="Basic Rules">
    <t>The following rules are used throughout this specification to describe
    basic parsing constructs. The US-ASCII coded character set is defined by 
    <xref target="RFC20" /> </t>
    <artwork type="abnf"
         xml:space="preserve">
<![CDATA[
OCTET          = <any 8-bit sequence of data>
CHAR           = <any US-ASCII character (octets 0 - 127)>
UPALPHA        = <any US-ASCII uppercase letter "A".."Z">
LOALPHA        = <any US-ASCII lowercase letter "a".."z">
ALPHA          = UPALPHA / LOALPHA
DIGIT          = <any US-ASCII digit "0".."9">
CTL            = <any US-ASCII control character (octets 0 - 31) and DEL (127)>
CR             = <US-ASCII CR, carriage return (13)>
LF             = <US-ASCII LF, linefeed (10)>
SP             = <US-ASCII SP, space (32)>
HT             = <US-ASCII HT, horizontal-tab (9)>
<">            = <US-ASCII double-quote mark (34)>
CRLF           = CR LF
LWS            = [CRLF] 1*( SP / HT )
TEXT           = <any OCTET except CTLs, but including LWS>
COMMA          = <US-ASCII comma (44)>
      ]]>
</artwork>
   </section>
  </section>
  <section title="Data"
           anchor="data">
   <section title="OpenSocial-Account" anchor="OpenSocial-Account">
     <t>TODO</t>
   </section>
   <section title="OpenSocial-Address" anchor="OpenSocial-Address">
     <t>TODO</t>
   </section>
   <section title="OpenSocial-AppData" anchor="OpenSocial-AppData">
     <t>TODO</t>
   </section>
   <section title="OpenSocial-Boolean" anchor="OpenSocial-Boolean">
     <t>TODO</t>
   </section>
   <section title="OpenSocial-Collection"
            anchor="OpenSocial-Collection">
    <t>Many service operations return a list of OpenSocial resources. Lists are
    always returned in the "list" field of the result. Lists can either be the
    full set of resources or a pageable subset. If the operation supports
    random access indexing of the full list it will support the "startIndex"
    and "count" parameters which control what sublist of the full list is
    returned. The paging mechanisms described here are based on the OpenSearch
    standard with the additional requirement that all indexes are 0 based.</t>
    <artwork type="abnf"
         xml:space="preserve">
OpenSocial-Collection = "{"
                        "result : {"
                          [ "totalResults : " number "," ]
                          [ "startIndex : " number "," ]
                          [ "itemsPerPage : " number ", ]
                          [ "isFiltered : " ( "true" / "false" ) "," ]
                          [ "isUpdatedSince : " ( "true" / "false" ) "," ]
                          [ "itemsPerPage : " number "," ]
                          "list :" OpenSocial-Objects 
                        "}"
                      "}"
OpenSocial-Objects = "[" #<x:ref>OpenSocial-Object</x:ref> "]"
</artwork>
   </section>
   <section title="OpenSocial-Date" anchor="OpenSocial-Date">
     <t>TODO</t>
   </section>
   <section title="OpenSocial-Date-UTC-Offset" anchor="OpenSocial-Date-UTC-Offset">
     <t>TODO</t>
   </section>
   <section title="OpenSocial-Name"
            anchor="OpenSocial-Name">
    <t>TODO</t>
   </section>
   <section title="OpenSocial-Organization" anchor="OpenSocial-Organization">
     <t>TODO</t>
   </section>
   <section title="OpenSocial-Person"
            anchor="OpenSocial-Person">
     <t>Each person returned MUST include the "id", "name", and "thumbnailUrl" 
     fields with 
     non-empty values, but all other fields are optional, and it is recognized 
     that not all Service Providers will be able to provide data for all the 
     supported fields. The field list below is broad so that there is a standard 
     field name available among Service Providers that do support any of these 
     fields.</t>
     <artwork type="abnf">
<x:highlight>OpenSocial-Person</x:highlight>          = "{"
                               "id :" OpenSocial-User-ID ","
                               "displayName :" string ","
                               [ #OpenSocial-Person-Field ]
                             "}"</artwork>
     <t>Valid definitions for OpenSocial-Person-Field are listed in the table below.</t>
     <texttable>
      <ttcol align="left" width="15%">Field Name</ttcol>
      <ttcol align="left" width="21%">Field Type</ttcol>
      <ttcol align="left">Description</ttcol>
      <c>accounts</c>
      <c><x:ref>OpenSocial-Plural-Field</x:ref> &lt;<x:ref>OpenSocial-Account</x:ref>&gt;</c>
      <c>An online account held by this Person.</c>
      <c>addresses</c>
      <c><x:ref>OpenSocial-Plural-Field</x:ref> &lt;<x:ref>OpenSocial-Address</x:ref>&gt;</c>
      <c>A physical mailing address for this Person.</c>
      <c>anniversary</c>
      <c><x:ref>OpenSocial-Date</x:ref></c>
      <c>The wedding anniversary of this person. The value MUST be a valid
      xs:date (e.g. 1975-02-14). The year value MAY be set to 0000 when the
      year is not available.</c>
      <c>appdata</c>
      <c><x:ref>OpenSocial-Plural-Field</x:ref> &lt;<x:ref>OpenSocial-AppData</x:ref>&gt;</c>
      <c>A collection of AppData keys and values.</c>
      <c>birthday</c>
      <c><x:ref>OpenSocial-Date</x:ref></c>
      <c>The birthday of this person. The value MUST be a valid xs:date (e.g.
      1975-02-14). The year value MAY be set to 0000 when the age of the Person
      is private or the year is not available.</c>
      <c>connected</c>
      <c><x:ref>OpenSocial-Boolean</x:ref></c>
      <c>Boolean value indicating whether the user and this Person have
      established a bi-directionally asserted connection of some kind on the
      Service Provider's service. The value MUST be either true or false. The
      value MUST be true if and only if there is at least one value for the
      relationship field, described below, and is thus intended as a summary
      value indicating that some type of bi-directional relationship exists,
      for Consumers that aren't interested in the specific nature of that
      relationship. For traditional address books, in which a user stores
      information about other contacts without their explicit acknowledgment,
      or for services in which users choose to "follow" other users without
      requiring mutual consent, this value will always be false.</c>
      <c>displayName</c>
      <c>string</c>
      <c><x:highlight>Required.</x:highlight> The name of this Person, suitable for display to end-users. Each
      Person returned MUST include a non-empty displayName value. The name
      SHOULD be the full name of the Person being described if known (e.g.
      Cassandra Doll or Mrs. Cassandra Lynn Doll, Esq.), but MAY be a username
      or handle, if that is all that is available (e.g. doll). The value
      provided SHOULD be the primary textual label by which this Person is
      normally displayed by the Service Provider when presenting it to
      end-users.</c>
      <c>emails</c>
      <c><x:ref>OpenSocial-Plural-Field</x:ref> &lt;string&gt;</c>
      <c>E-mail address for this Person. The value SHOULD be canonicalized by
      the Service Provider, e.g.joseph@plaxo.com instead of
      joseph@PLAXO.COM.</c>
      <c>gender</c>
      <c>string</c>
      <c>The gender of this person. Service Providers SHOULD return one of the
      following Canonical Values, if appropriate:male, female, or undisclosed,
      and MAY return a different value if it is not covered by one of these
      Canonical Values.</c>
      <c>id</c>
      <c><x:ref>OpenSocial-User-ID</x:ref></c>
      <c><x:highlight>Required.</x:highlight> Unique identifier for the Person. Each Person returned MUST include a
      non-empty id value. This identifier MUST be unique across this user's
      entire set of people, but MAY not be unique across multiple users' data.
      It MUST be a stable ID that does not change when the same contact is
      returned in subsequent requests. For instance, an e-mail address is not a
      good id, because the same person may use a different e-mail address in
      the future. Usually, in internal database ID will be the right choice
      here, e.g. "12345".</c>
      <c>ims</c>
      <c><x:ref>OpenSocial-Plural-Field</x:ref> &lt;string&gt;</c>
      <c>Instant messaging address for this Person. No official
      canonicalization rules exist for all instant messaging addresses, but
      Service Providers SHOULD remove all whitespace and convert the address to
      lowercase, if this is appropriate for the service this IM address is used
      for. Instead of the standard Canonical Values for type, this field
      defines the following Canonical Values to represent currently popular IM
      services: aim, gtalk, icq, xmpp,msn, skype, qq, and yahoo.</c>
      <c>name</c>
      <c><x:ref>OpenSocial-Name</x:ref></c>
      <c>The broken-out components and fully formatted version of the person's
      real name.</c>
      <c>nickname</c>
      <c>string</c>
      <c>The casual way to address this Person in real life, e.g. "Bob" or
      "Bobby" instead of "Robert". This field SHOULD NOT be used to represent a
      user's username (e.g. jsmarr or daveman692); the latter should be
      represented by the preferredUsername field.</c>
      <c>note</c>
      <c>string</c>
      <c>Notes about this person, with an unspecified meaning or usage
      (normally notes by the user about this person). This field MAY contain
      newlines.</c>
      <c>organizations</c>
      <c><x:ref>OpenSocial-Plural-Field</x:ref> &lt;<x:ref>OpenSocial-Organization</x:ref>&gt;</c>
      <c>A current or past organizational affiliation of this Person.</c>
      <c>phoneNumbers</c>
      <c><x:ref>OpenSocial-Plural-Field</x:ref> &lt;string&gt;</c>
      <c>Phone number for this Person. No canonical value is assumed here. In
      addition to the standard Canonical Values for type, this field also
      defines the additional Canonical Values mobile, fax, and pager.</c>
      <c>photos</c>
      <c><x:ref>OpenSocial-Plural-Field</x:ref> &lt;string&gt;</c>
      <c>URL of a photo of this person. The value SHOULD be a canonicalized
      URL, and MUST point to an actual image file (e.g. a GIF, JPEG, or PNG
      image file) rather than to a web page containing an image. Service
      Providers MAY return the same image at different sizes, though it is
      recognized that no standard for describing images of various sizes
      currently exists. Note that this field SHOULD NOT be used to send down
      arbitrary photos taken by this user, but specifically profile photos of
      the contact suitable for display when describing the contact.</c>
      <c>preferredUsername</c>
      <c>string</c>
      <c>The preferred username of this person on sites that ask for a username
      (e.g. jsmarr or daveman692). This field may be more useful for describing
      the owner (i.e. the value when /@me/@self is requested) than the user's
      person, e.g. Consumers MAY wish to use this value to pre-populate a
      username for this user when signing up for a new service.</c>
      <c>published</c>
      <c><x:ref>OpenSocial-Date</x:ref></c>
      <c>The date this Person was first added to the user's address book or
      friends list (i.e. the creation date of this entry). The value MUST be a
      valid 
      <xref target="XSdateTime" /> (e.g. 2008-01-23T04:56:22Z).</c>
      <c>relationships</c>
      <c><x:ref>OpenSocial-Plural-Field</x:ref> &lt;string&gt;</c>
      <c>A bi-directionally asserted relationship type that was established
      between the user and this person by the Service Provider. The value
      SHOULD conform to one of the XFN relationship values (e.g. kin, friend,
      contact, etc.) if appropriate, but MAY be an alternative value if needed.
      Note this field is a parallel set of category labels to the tags field,
      but relationships MUST have been bi-directionally confirmed, whereas tags
      are asserted by the user without acknowledgment by this Person. Note that
      this field consists only of a string value.</c>
      <c>tags</c>
      <c><x:ref>OpenSocial-Plural-Field</x:ref> &lt;string&gt;</c>
      <c>A user-defined category label for this person, e.g. "favorite" or
      "web20". These values SHOULD be case-insensitive, and there SHOULD NOT be
      multiple tags provided for a given person that differ only in case. Note
      that this field consists only of a string value.</c>
      <c>updated</c>
      <c><x:ref>OpenSocial-Date</x:ref></c>
      <c>The most recent date the details of this Person were updated (i.e. the
      modified date of this entry). The value MUST be a valid 
      <xref target="XSdateTime" /> (e.g. 2008-01-23T04:56:22Z). If this Person
      has never been modified since its initial creation, the value MUST be the
      same as the value of published. Note the updatedSince Query Parameter can
      be used to select only people whose updated value is equal to or more
      recent than a given xs:dateTime. This enables Consumers to repeatedly
      access a user's data and only request newly added or updated contacts
      since the last access time.</c>
      <c>urls</c>
      <c><x:ref>OpenSocial-Plural-Field</x:ref> &lt;string&gt;</c>
      <c>URL of a web page relating to this Person. The value SHOULD be
      canonicalized by the Service Provider, e.g.http://josephsmarr.com/about/
      instead of JOSEPHSMARR.COM/about/. In addition to the standard Canonical
      Values for type, this field also defines the additional Canonical Values
      blog and profile.</c>
      <c>utcOffset</c>
      <c><x:ref>OpenSocial-Date-UTC-Offset</x:ref></c>
      <c>The offset from UTC of this Person's current time zone, as of the time
      this response was returned. The value MUST conform to the offset portion
      of 
      <xref target="XSdateTime" />, e.g. -08:00. Note that this value MAY
      change over time due to daylight saving time, and is thus meant to
      signify only the current value of the user's timezone offset.</c>
     </texttable>
     <t>The following additional fields are defined, based on
     their specification in the OpenSocial Javascript API, and are represented with strings: aboutMe,
     bodyType,currentLocation, drinker, ethnicity, fashion, happiestWhen,
     humor, livingArrangement, lookingFor, profileSong,profileVideo,
     relationshipStatus, religion, romance, scaredOf, sexualOrientation,
     smoker, and status.</t>
   </section>
   <section title="OpenSocial-Plural-Field" anchor="OpenSocial-Plural-Field">
     <texttable>
      <ttcol align="left" width="10%">Field Name</ttcol>
      <ttcol align="left" width="15%">Field Type</ttcol>
      <ttcol align="left">Description</ttcol>
      <c>value</c>
      <c><x:ref>OpenSocial-Object</x:ref></c>
      <c>The primary value of this field, e.g. the actual e-mail address, phone
      number, or URL. When specifying a sortBy field in the Query Parameters for
      a Plural Field, the default meaning is to sort based on this value
      sub-field. Each non-empty Plural Field value MUST contain at least the
      value sub-field, but all other sub-fields are optional.</c>
      <c>type</c>
      <c>string</c>
      <c>The type of field for this instance, usually used to label the
      preferred function of the given contact information. Unless otherwise
      specified, this string value specifies Canonical Values of work, home,
      and other.</c>
      <c>primary</c>
      <c><x:ref>OpenSocial-Boolean</x:ref></c>
      <c>A Boolean value indicating whether this instance of the Plural Field
      is the primary or preferred value of for this field, e.g. the preferred
      mailing address or primary e-mail address. Service Providers MUST NOT
      mark more than one instance of the same Plural Field as primary="true",
      and MAY choose not to mark any fields as primary, if this information is
      not available. For efficiency, Service Providers SHOULD NOT mark all
      non-primary fields with primary="false", but should instead omit this
      sub-field for all non-primary instances.</c>
     </texttable>
     <t>When returning Plural Fields, Service Providers SHOULD canonicalize the
     value returned, if appropriate (e.g. for e-mail addresses and URLs).
     Providers MAY return the same value more than once with different types
     (e.g. the same e-mail address may used for work and home), but SHOULD NOT
     return the same (type, value) combination more than once per Plural Field,
     as this complicates processing by the Consumer.</t>
   </section>
  </section>
  <section title="Rules for mapping JSON to XML"
           anchor="JSON-to-XML">
   <t>Singular fields are encoded as string key/value pairs in JSON and tags
   with text content in XML, e.g. "field": "value" and
   &lt;field&gt;value&lt;/field&gt; respectively.</t>
   <t>Plural fields are encoded as arrays in JSON and repeated tags in XML,
   e.g. "fields": [ "value1", "value2" ] and
   &lt;fields&gt;value1&lt;/field&gt;&lt;fields&gt;value2&lt;/field&gt;
   respectively.</t>
   <t>Nodes with multiple sub-nodes are represented as objects in JSON and tags
   with sub-tags in XML, e.g. "field": { "subfield1": "value1", "subfield2":
   "value2" } and
   &lt;field&gt;&lt;subfield1&gt;value1&lt;/subfield1&gt;&lt;subfield2&gt;value2&lt;/subfield2&gt;&lt;/field&gt;
   respectively.</t>
  </section>
 </middle>
 <back>
  <references>
   <reference anchor="RFC2234">
     <seriesInfo name='RFC' value='2234' />
   </reference>
   <reference anchor="RFC20">
     <seriesInfo name='RFC' value='20' />
   </reference>
   <reference anchor="RFC3986">
     <seriesInfo name='RFC' value='3986' />
   </reference>   
   <reference anchor="RFC4627">
     <seriesInfo name='RFC' value='4627' />
   </reference>   
   <reference anchor="Gadget-Specification">
   </reference>   


   <reference anchor='RFC2119'>
    <front>
     <title>Key words for use in RFCs to Indicate Requirement Levels</title>
     <author initials='S.'
             surname='Bradner'
             fullname='Scott Bradner'>
      <organization abbrev='HarvardU'>Harvard University</organization>
     </author>
     <date month='March'
           year='1997' />
    </front>
    <seriesInfo name='RFC' value='2119' />
   </reference>
   <reference anchor='RFC2606'>
    <front>
     <title>Reserved Top Level DNS Names</title>
     <author initials='D.'
             surname='Eastlake'
             fullname='Donald E. Eastlake 3rd'>
      <organization abbrev='IBM'>IBM</organization>
     </author>
     <author initials='A.'
             surname='Panitz'
             fullname='Aliza R. Panitz'></author>
     <date month='June'
           year='1999' />
    </front>
    <seriesInfo name='RFC'
                value='2606' />
   </reference>
   <reference anchor='RFC2616'>
    <front>
     <title>Hypertext Transfer Protocol -- HTTP/1.1</title>
    </front>
    <seriesInfo name='RFC'
                value='2616' />
   </reference>
   <reference anchor='JSPEL'
              target="https://jsp.dev.java.net/spec/jsp-2_1-fr-spec-el.pdf">
    <front>
     <title>Java Server Pages Expression Language</title>
     <author initials='K.'
             surname='Chung'
             fullname='Kin-Man Chung'></author>
     <author initials='P.'
             surname='DeLisle'
             fullname='Pierre Delisle'></author>
     <author initials='M.'
             surname='Roth'
             fullname='Mark Roth'></author>
     <date month='May'
           year='2006' />
    </front>
   </reference>
   <reference anchor="XSdateTime"
              target="http://www.w3.org/TR/xmlschema-2/#dateTime">
    <front>
     <title>XML Schema Part 2: Datatypes Second Edition</title>
     <author initials='P.V.'
             surname='Biron'
             fullname='Paul V. Biron'>
      <organization>Kaiser Permanente, for Health Level Seven</organization>
     </author>
     <author initials='A.'
             surname='Malhotra'
             fullname='Ashok Malhotra'>
      <organization>Microsoft</organization>
     </author>
     <date month='October'
           year='2004' />
    </front>
   </reference>
  </references>
 </back>
</rfc>
